# 코파일럿 지침

이 파일은 이 프로젝트에서 코드 생성 및 개발 작업을 수행할 때 GitHub Copilot이 참조할 가이드라인을 제공합니다.

## 프로젝트 개요

이 프로젝트는 Next.js 14로 구축된 QR 코드 생성기입니다. TypeScript, Tailwind CSS, shadcn/ui를 포함한 현대적인 기술 스택을 활용하여 견고하고 잘 구조화된 애플리케이션을 구축합니다. 포괄적인 로깅, 보안 및 테스트 기능을 갖춘 빠르고 안정적이며 사용자 친화적인 QR 코드 생성 경험을 제공하는 것이 목표입니다.

### 핵심 기술 스택

- **프레임워크**: Next.js 14 (App Router)
- **언어**: TypeScript
- **스타일링**: Tailwind CSS, shadcn/ui
- **데이터베이스**: PostgreSQL (Supabase)
- **ORM**: Prisma
- **인증**: NextAuth.js
- **테스트**: Jest, Testing Library
- **QR 코드**: qr-code-styling, qrcode

## 일반 지침

### 코드 작성 원칙

- **응답 언어**: 모든 제안과 응답을 **한국어**로 제공해주세요.
- **맥락 유지**: 현재 작업 중인 파일, 주변 코드, 기타 관련된 열린 파일을 바탕으로 맥락을 이해하고 활용하여 코드를 제안하세요.
- **코드 스타일 준수**: 프로젝트의 기존 코드 스타일(들여쓰기, 명명 규칙 등)을 파악하고 일관된 스타일로 코드를 생성하세요.
- **코드 가독성**: 간결함보다 코드 가독성을 우선시하세요. 설명적인 변수명, 명확한 함수명, 논리적인 코드 구조를 사용하세요.
- **불필요한 주석 피하기**: 코드 생성 시 **주석을 추가하지 마세요.** 개발자가 필요에 따라 수동으로 주석을 추가할 것입니다.
- **커밋 메시지**: 커밋 메시지를 작성할 때는 프로젝트 루트의 `.gitmessage.txt` 파일에 정의된 가이드라인을 준수하세요. `<type>(<scope>): <description>` 형식을 사용하고, 적절한 타입과 스코프를 선택하여 일관성 있는 커밋 히스토리를 유지하세요.

### 코드 품질

- **관용적 코드**: 특정 프로그래밍 언어와 프레임워크의 일반적인 관용구와 모범 사례를 사용하여 코드를 작성하세요.
- **모듈화 및 재사용성**: 가능한 경우 코드를 모듈화하고 재사용 가능하게 만드는 것을 고려하세요.
- **복잡성 관리**: 복잡한 로직은 더 작고 이해하기 쉬운 부분으로 나누세요.
- **오류 처리**: 적절한 오류 처리 메커니즘을 제안하도록 노력하세요.

## 기술 스택별 지침

### Next.js

- **App Router**: 라우팅, 레이아웃, 서버 컴포넌트에는 App Router를 활용하세요.
- **Server Actions**: 서버 측에서 데이터 변경 및 페칭에는 Server Actions를 사용하세요.
- **API Routes**: 클라이언트 측 데이터 페칭에는 API Routes를 사용하세요.
- **HTTP 클라이언트**: 일관된 오류 처리와 요청/응답 인터셉터를 보장하기 위해 `fetch` 대신 `axios`를 모든 API 호출에 사용하세요.

### React

- **상태 관리**: `useState` 대신 폼 상태 관리에는 `react-hook-form`을 선호하세요. 전역 상태 관리에는 `Zustand`를 사용하세요.
- **컴포넌트화**: 복잡한 컴포넌트를 더 작고 재사용 가능한 컴포넌트로 나누세요.
- **데이터 페칭**: 서버 상태 관리와 캐싱에는 `@tanstack/react-query`를 사용하세요.

### 폼 처리

- **React Hook Form**: 폼 검증에는 `@hookform/resolvers`와 함께 `react-hook-form`을 사용하세요.
- **검증**: 스키마 검증과 타입 안전성을 위해 `zod`를 사용하세요.
- **필드 검증**: 타입 안전성과 애플리케이션 전반의 일관된 검증 규칙을 보장하기 위해 항상 Zod 스키마를 폼 필드 데이터 검증에 사용하세요.

### 인증 & 보안

- **NextAuth.js**: Prisma 어댑터와 함께 NextAuth.js를 인증에 사용하세요.
- **데이터베이스**: 인증 데이터는 `@auth/prisma-adapter`를 사용하여 저장됩니다.

### 데이터베이스

- **Prisma**: PostgreSQL과 함께 Prisma를 ORM으로 사용하세요.
- **Supabase**: 프로덕션 데이터베이스는 Row Level Security(RLS)가 적용된 Supabase PostgreSQL을 사용합니다.

### QR 코드 생성

- **라이브러리**: 고급 QR 코드 커스터마이징에는 `qr-code-styling`, 서버 측 스타일링에는 `qr-code-styling-node`, 기본 생성에는 `qrcode`, React 컴포넌트에는 `qrcode.react`를 사용하세요.
- **Canvas**: 서버 측 QR 코드 렌더링에는 `canvas` 라이브러리를 사용하세요.

### UI & 스타일링

- **컴포넌트 사용**: shadcn/ui 컴포넌트를 사용할 때는 `@/components/ui/...`에서 import하세요.
- **컴포넌트 생성**: 새 컴포넌트를 생성할 때는 shadcn/ui 컴포넌트의 기존 구조와 스타일을 따르세요.
- **Radix UI**: 모든 UI 컴포넌트는 Radix UI 프리미티브를 기반으로 구축됩니다.
- **유틸리티 우선**: Tailwind CSS의 유틸리티 우선 접근 방식을 채택하세요.
- **`tailwind-merge`**: 충돌하는 CSS 클래스를 처리하기 위해 `tailwind-merge` 라이브러리를 사용하세요.
- **`clsx`**: 조건부 클래스명에는 `clsx` 라이브러리를 사용하세요.
- **애니메이션**: 컴포넌트 애니메이션에는 `tailwindcss-animate`를 사용하세요.

### 상태 관리

- **전역 상태**: 전역 상태 관리에는 Zustand를 사용하세요. `hooks` 디렉토리에 스토어를 생성하세요.

### UI 컴포넌트 라이브러리

- **테이블**: 데이터 테이블에는 `@tanstack/react-table`을 사용하세요.
- **알림**: 토스트 알림에는 `sonner`를 사용하세요.
- **날짜 선택기**: 날짜 처리에는 `date-fns`와 함께 `react-day-picker`를 사용하세요.
- **차트**: 데이터 시각화에는 `recharts`를 사용하세요.
- **아이콘**: 아이콘에는 `lucide-react`를 사용하세요.
- **캐러셀**: 캐러셀 컴포넌트에는 `embla-carousel-react`를 사용하세요.
- **패널**: 크기 조정 가능한 레이아웃 패널에는 `react-resizable-panels`를 사용하세요.
- **드로어**: 모바일 드로어 컴포넌트에는 `vaul`을 사용하세요.
- **명령**: 명령 팔레트 인터페이스에는 `cmdk`를 사용하세요.
- **OTP**: OTP 입력 컴포넌트에는 `input-otp`를 사용하세요.

### 유틸리티 라이브러리

- **HTTP 클라이언트**: HTTP 요청에는 `axios`를 사용하세요.
- **쿼리 문자열**: 쿼리 문자열 파싱에는 `qs`를 사용하세요.
- **날짜 라이브러리**: 날짜 조작에는 `date-fns`를 사용하세요.
- **유틸리티 함수**: 현대적인 유틸리티 함수를 위해 `@toss/utils`와 `es-toolkit`을 사용하세요.
- **JWT**: JWT 토큰 처리에는 `jose`를 사용하세요.
- **쿠키**: 쿠키 관리에는 `cookies-next`를 사용하세요.
- **DOM 조작**: 서버 측 DOM 작업에는 `jsdom`을 사용하세요.
- **주소 검색**: 한국 주소 검색 기능에는 `react-daum-postcode`를 사용하세요.
- **CSS 유틸리티**: 컴포넌트 변형 처리에는 `class-variance-authority`를, 클래스 병합에는 `tailwind-merge`를 사용하세요.
- **테마**: 테마 관리에는 `next-themes`를 사용하세요.

## 프로젝트 구조

- `app/`: Next.js App Router 구조
  - `actions/`: Server Actions
  - `api/`: API Routes
  - `auth/`: 인증 페이지
  - `dashboard/`: 대시보드 페이지
  - `qrcode/`: QR 코드 생성 페이지
- `components/`: React 컴포넌트
  - `ui/`: shadcn/ui 컴포넌트
- `lib/`: 유틸리티 함수
- `hooks/`: 커스텀 훅과 Zustand 스토어
- `types/`: TypeScript 타입 정의
- `context/`: React 컨텍스트

## 테스트 및 품질 보장

### TDD (테스트 주도 개발) 지침

- **TDD 접근법**: 모든 새로운 기능 개발에 대해 Red-Green-Refactor 사이클을 따르세요:
  1. **Red**: 실패하는 테스트를 먼저 작성하세요
  2. **Green**: 테스트를 통과하는 최소한의 코드를 작성하세요
  3. **Refactor**: 테스트를 유지하면서 코드를 개선하세요
- **테스트 커버리지 목표**: 모든 모듈에서 **90% 이상**의 테스트 커버리지를 유지하세요
- **테스트 우선 개발**: 새로운 기능을 구현하기 전에 항상 테스트를 작성하세요
- **코드 품질 게이트**: 새 코드는 병합 전에 모든 테스트를 통과하고 커버리지 임계값을 충족해야 합니다

### 테스트 프레임워크 및 도구

- **테스트 러너**: React 컴포넌트를 위한 jest-environment-jsdom과 함께 Jest를 사용하세요
- **테스트 라이브러리**:
  - 컴포넌트 테스트를 위한 `@testing-library/react`
  - DOM 어설션을 위한 `@testing-library/jest-dom`
  - 사용자 상호작용 시뮬레이션을 위한 `@testing-library/user-event`
- **테스트 구조**: 소스 구조를 미러링하는 `__tests__/` 디렉토리에 테스트를 구성하세요
- **모킹 전략**: 외부 의존성, 데이터베이스 호출, API 요청에 Jest 모킹을 사용하세요
- **커버리지 리포팅**: 상세한 분석을 위해 HTML 출력으로 커버리지 리포트를 생성하세요

### 테스트 모범 사례

- **컴포넌트 테스트**: 구현 세부사항이 아닌 컴포넌트 동작을 테스트하세요
- **단위 테스트**: 개별 함수와 유틸리티를 독립적으로 테스트하세요
- **통합 테스트**: 적절한 모킹과 함께 API 라우트와 서버 액션을 테스트하세요
- **오류 처리**: 성공과 실패 시나리오 모두를 테스트하세요
- **에지 케이스**: 경계 조건과 오류 상태에 대한 테스트를 포함하세요
- **접근성**: 해당하는 경우 접근성 테스트를 포함하세요
- **성능**: 테스트 실행 시간을 모니터링하고 느린 테스트를 최적화하세요

## 피드백 및 개선

Copilot의 제안이 기대에 부합하지 않는 경우, 적극적으로 수정하고 피드백을 제공하여 Copilot이 향후 더 나은 제안을 할 수 있도록 도와주세요.
